version: "3.9"
services:
  plasma-store:
    image: "icrar/plasma_store:0.3"
    volumes: "./plasma:/plasma"
  mswriter:
      image: ${IMAGE}
      volumes: "./plasma:/plasma"
      depends_on:
        - "plasma-store"
  emu-receive:
    image: ${IMAGE}
    volumes: "./plasma:/plasma"
    depends_on:
      - "plasma-store"
      - "mswriter"
  emu-send:
    image: ${IMAGE}
    volumes: "./data:/data"
    depends_on:
      - "emu-receive"
  integration-tests:
    image: ${IMAGE}
    volumes:
      - .:/src
      - ../test:/test
    working_dir: /src
    command:
      [
        "pytest"
      ]
    depends_on:
      - "emu-send"
      - "emu-receive"
      - "mswriter"
      - "plasma-store"

